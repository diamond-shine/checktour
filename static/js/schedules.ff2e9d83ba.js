(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{215:function(e,t,r){"use strict";r.r(t);var n=r(7),o=(r(245),r(10),r(36));function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s={components:{ModelForm:r(242).a},mixins:[o.b],data:function(){return{formData:null}},beforeRouteEnter:function(e,t,r){return r((function(e){return e.lock(e.create())}))},computed:{backRoute:function(){return{name:"schedules.list"}}},methods:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(r,!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({onClickCancel:function(){this.$refs.form.restore(),this.$router.push(this.backRoute)}},Object(n.mapActions)("schedules",{create:function(e){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))},store:function(e,t){var r,n;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,regeneratorRuntime.awrap(e("store",{form:t}));case 2:return r=o.sent,n=r.form,o.next=6,regeneratorRuntime.awrap(t.setData(n));case 6:this.$router.push(this.backRoute);case 7:case"end":return o.stop()}}),null,this)}}))},i=r(1),c=Object(i.a)(s,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-sidebar-layout",{attrs:{locked:e.locked},scopedSlots:e._u([{key:"header",fn:function(){return[r("v-sidebar-layout-header",{attrs:{title:e.$t("Add schedule"),"back-route":e.backRoute}})]},proxy:!0},{key:"body",fn:function(){return[r("v-form",{ref:"form",attrs:{data:e.formData,name:"schedules"},on:{submit:e.store},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.form,o=t.submit;return[r("model-form",{attrs:{form:n},on:{submit:o}},[r("el-button",{attrs:{type:"success","native-type":"submit"}},[e._v(e._s(e.$t("Create"))+"\n                ")]),e._v(" "),r("el-button",{on:{click:e.onClickCancel}},[e._v(e._s(e.$t("Cancel"))+"\n                ")])],1)]}}])})]},proxy:!0}])})}),[],!1,null,null,null);t.default=c.exports},218:function(e,t,r){"use strict";r.r(t);var n=r(7),o=(r(10),r(36)),a=r(242),u=r(2);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(r,!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l={mixins:[o.b],components:{ModelForm:a.a},data:function(){return{formData:null}},beforeRouteEnter:function(e,t,r){return r((function(e){return e.lock(e.edit())}))},beforeRouteUpdate:function(e,t,r){e.params.scheduleId!==t.params.scheduleId&&this.lock(this.edit()),r()},computed:i({backRoute:function(){return{name:"schedules.view",params:{scheduleId:this.$routeParam("scheduleId")}}}},Object(u.b)([{name:"schedules.update",process:"schedules@edit.update"}])),methods:i({onClickCancel:function(){this.$refs.form.restore(),this.$router.push(this.backRoute)}},Object(n.mapActions)("schedules",{edit:function(e){var t,r;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(e("edit",{scheduleId:this.$routeParam("scheduleId")}));case 2:t=n.sent,r=t.form,this.$data.formData=r;case 5:case"end":return n.stop()}}),null,this)},update:function(e,t){var r,n;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,regeneratorRuntime.awrap(e("update",{scheduleId:this.$routeParam("scheduleId"),form:t}));case 2:return r=o.sent,n=r.form,o.next=6,regeneratorRuntime.awrap(t.setData(n));case 6:this.$ee.emit("schedules@list.fetch"),this.$router.push(this.backRoute);case 8:case"end":return o.stop()}}),null,this)}}))},d=r(1),f=Object(d.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-sidebar-layout",{attrs:{locked:e.locked},scopedSlots:e._u([{key:"header",fn:function(){return[r("v-sidebar-layout-header",{attrs:{title:e.$t("Edit record"),"back-route":e.backRoute}})]},proxy:!0},{key:"body",fn:function(){return[r("v-form",{ref:"form",attrs:{data:e.formData,name:"schedules"},on:{submit:e.update},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.form,o=t.submit;return[r("model-form",{attrs:{form:n},on:{submit:o}},[r("el-button",{attrs:{type:"success","native-type":"submit"}},[e._v(e._s(e.$t("Save"))+"\n                ")]),e._v(" "),r("el-button",{on:{click:e.onClickCancel}},[e._v(e._s(e.$t("Cancel"))+"\n                ")])],1)]}}])})]},proxy:!0}])})}),[],!1,null,null,null);t.default=f.exports},242:function(e,t,r){"use strict";var n={props:{users:{type:Array,required:!0},form:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data:function(){return{lock:!0,term:""}},computed:{fetchToursUrl:function(){return"schedules/tours-autocomplete"},fetchExcursionrUrl:function(){return"schedules/".concat(this.form.data.tour_id,"/date-autocomplete")}},methods:{onChangeDay:function(){this.form.data.assigned_at=null},onChangeTime:function(e){var t=this,r=e.find((function(e){return e.id==t.form.data.excursion_id}));this.form.data.assigned_at=r.date_time},onSubmit:function(){this.$emit("submit",this.$props.form,!0)},toggle:function(){this.$data.lock=!this.$data.lock}}},o=r(1),a=Object(o.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{attrs:{disabled:e.disabled,"label-position":"top"},nativeOn:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[r("el-form-item",{attrs:{label:e.$t("Tour"),error:e.form.formatErrors("tour_id")}},[r("v-autocomplete",{attrs:{id:"tours",url:e.fetchToursUrl},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.items;t.fetching;return[r("el-select",{attrs:{placeholder:e.$t("Tour"),disabled:!0},model:{value:e.form.data.tour_id,callback:function(t){e.$set(e.form.data,"tour_id",t)},expression:"form.data.tour_id"}},e._l(n,(function(e){return r("el-option",{key:"tour_"+e.id,attrs:{label:e.name,value:e.id}})})),1)]}}])})],1),e._v(" "),r("el-form-item",{attrs:{label:e.$t("User"),error:e.form.formatErrors("user_id")}},[r("el-select",{attrs:{placeholder:e.$t("User"),disabled:!0},model:{value:e.form.data.user_id,callback:function(t){e.$set(e.form.data,"user_id",t)},expression:"form.data.user_id"}},e._l(e.users,(function(e){return r("el-option",{key:"user_"+e.id,attrs:{label:e.first_name+" "+e.last_name,value:e.id}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:e.$t("Day"),error:e.form.formatErrors("excursion_id")}},[r("v-autocomplete",{attrs:{id:"excursion_list",url:e.fetchExcursionrUrl,disabled:!e.form.data.tour_id},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.items;t.fetching;return[r("el-select",{attrs:{placeholder:e.$t("Select"),disabled:!e.form.data.tour_id},on:{change:e.onChangeDay},model:{value:e.form.data.day,callback:function(t){e.$set(e.form.data,"day",t)},expression:"form.data.day"}},e._l(n,(function(e){return r("el-option",{key:"e_"+e[0].id,attrs:{label:e[0].day_title,value:e[0].day}})})),1)]}}])})],1),e._v(" "),r("el-form-item",{attrs:{label:e.$t("Time"),error:e.form.formatErrors("assigned_at")}},[r("v-autocomplete",{attrs:{id:"excursion_time",url:e.fetchExcursionrUrl,disabled:!e.form.data.tour_id},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.items;t.fetching;return[r("el-select",{attrs:{placeholder:e.$t("Select"),disabled:!e.form.data.tour_id},on:{change:function(t){e.onChangeTime(n.find((function(t){return t[0].day==e.form.data.day})))}},model:{value:e.form.data.excursion_id,callback:function(t){e.$set(e.form.data,"excursion_id",t)},expression:"form.data.excursion_id"}},e._l(n.find((function(t){return t[0].day==e.form.data.day})),(function(e){return r("el-option",{key:"time_"+e.id,attrs:{label:e.time,value:e.id}})})),1)]}}])})],1),e._v(" "),r("v-divider"),e._v(" "),e._t("default")],2)}),[],!1,null,null,null);t.a=a.exports},245:function(e,t,r){"use strict";var n=r(23),o=r(6);n.b.register("schedules.list",(function(e){e.push(Object(o.$t)("Sessions"),"schedules.list")})),t.a=n.b}}]);